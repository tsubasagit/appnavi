# よくある質問（FAQ）

## Googleスプレッドシート連携について

### Q1. Googleスプレッドシート連携がエラーになります

**A.** 以下の手順を確認してください：

#### 1. スプレッドシートの共有設定を確認

スプレッドシートを「リンクを知っている全員」に共有する必要があります：

1. Googleスプレッドシートを開く
2. 右上の「共有」ボタンをクリック
3. 「リンクを知っている全員」に変更
4. 「閲覧者」を選択
5. 「完了」をクリック

#### 2. 完全なURLをコピー&ペースト

スプレッドシートのURLは完全なものを使用してください：

**正しい例：**
```
https://docs.google.com/spreadsheets/d/1c2bPLLCVvebx_7QBL7JilTBTGSUotLxEEQEpVCAPhM0/edit?usp=sharing
```

**間違った例：**
```
https://docs.google.com/spreadsheets/d/1
```

URLは必ずアドレスバーからコピーしてください。

#### 3. スプレッドシートにデータがあるか確認

- 1行目に見出し（列名）があること
- 2行目以降にデータが含まれていること

### Q2. サンプルスプレッドシートはありますか？

**A.** はい、以下のサンプルスプレッドシートをご利用いただけます：

**営業日報サンプル：**
https://docs.google.com/spreadsheets/d/1c2bPLLCVvebx_7QBL7JilTBTGSUotLxEEQEpVCAPhM0/edit?usp=sharing

このスプレッドシートには以下の列が含まれています：
- 日時
- 担当者
- 顧客/案件名
- 訪問目的
- (任意)活動内容

### Q3. エラーメッセージ別の対処法

#### 「400 Bad Request」エラー

**原因：** スプレッドシートURLが不完全、またはスプレッドシートの共有設定が正しくありません

**解決方法：**

1. **スプレッドシートの共有設定を確認**
   - スプレッドシートを開く
   - 右上の「共有」ボタンをクリック
   - 「リンクを知っている全員」に変更されているか確認
   - 「閲覧者」権限が設定されているか確認
   - 設定が正しくない場合は、一度共有設定を解除してから再度設定してください

2. **URLの確認**
   - スプレッドシートを開いて、アドレスバーから完全なURLをコピーしてください
   - URLは `https://docs.google.com/spreadsheets/d/` で始まる必要があります
   - `/edit` や `/view` が付いていても問題ありません

3. **ブラウザのキャッシュをクリア**
   - Ctrl+Shift+R（Windows）または Cmd+Shift+R（Mac）で強制リロード
   - または、ブラウザの設定からキャッシュをクリア

4. **別のブラウザで試す**
   - Chrome、Firefox、Edgeなど、別のブラウザで試してください

#### 「403 Forbidden」エラー

**原因：** スプレッドシートへのアクセスが拒否されました

**解決方法：**
1. スプレッドシートの共有設定を確認
2. 「リンクを知っている全員」に変更
3. 「閲覧者」権限を設定

#### 「404 Not Found」エラー

**原因：** スプレッドシートが見つかりません

**解決方法：**
- URLが正しいか確認してください
- スプレッドシートが削除されていないか確認してください
- URLをコピー&ペーストし直してください

#### 「CORSエラー」が発生する

**原因：** ファイルを直接開いている（`file://`プロトコル）

**解決方法：**
1. **推奨：** GitHub Pagesで開く
   - https://tsubasagit.github.io/appnavi/ にアクセス
   - ローカルサーバー不要で、すぐに使えます

2. **開発時：** ローカルサーバーを起動
   - `start-local-server.bat` をダブルクリック
   - または `python -m http.server 8000` を実行
   - `http://localhost:8000` で開く

### Q4. 認証は必要ですか？

**A.** いいえ、認証は不要です。

スプレッドシートを「リンクを知っている全員」に共有すれば、Googleアカウントのログインなしで利用できます。

### Q5. スプレッドシートのデータは読み取り専用ですか？

**A.** はい、スプレッドシートのデータは読み取り専用です。

- スプレッドシートからデータを読み込んで、アプリを作成します
- アプリのデータは、設定した保存先（ブラウザまたはFirebase）に保存されます
- スプレッドシート自体は変更されません

### Q6. スプレッドシートのデータを更新したい

**A.** スプレッドシートのデータを更新した後、アプリ側で再読み込みする必要があります。

現在の実装では、手動で再読み込みが必要です。今後のアップデートで自動同期機能を追加予定です。

### Q6-1. 特定のスプレッドシートでエラーが続く場合

**A.** 以下の手順を試してください：

1. **スプレッドシートの共有設定を再設定**
   - 一度共有設定を「制限付き」に戻す
   - 再度「リンクを知っている全員」に変更
   - 「閲覧者」を選択して「完了」をクリック

2. **スプレッドシートをコピーして新しいスプレッドシートを作成**
   - ファイル > コピーを作成
   - 新しいスプレッドシートで共有設定を「リンクを知っている全員」に設定
   - 新しいスプレッドシートのURLを使用

3. **スプレッドシートの形式を確認**
   - 1行目に見出し（列名）があること
   - 2行目以降にデータが含まれていること
   - 空の行や列が多すぎないこと

4. **スプレッドシートのサイズを確認**
   - 非常に大きなスプレッドシート（1000行以上）の場合、読み込みに時間がかかる可能性があります
   - 必要に応じて、データを分割してください

## その他のよくある質問

### Q7. ローカルサーバーを起動する必要がありますか？

**A.** いいえ、必要ありません。

GitHub Pagesで公開されているので、以下のURLにアクセスするだけで使えます：
- https://tsubasagit.github.io/appnavi/

ローカルサーバーは開発時にのみ必要です。

### Q8. データはどこに保存されますか？

**A.** 2つの選択肢があります：

1. **ブラウザに保存（ローカル）**
   - 同じブラウザ・同じデバイスでのみアクセス可能
   - 設定不要で、すぐに使えます

2. **Firebase（クラウド）**
   - 複数のデバイスや複数人で共有可能
   - Firebase設定が必要です

初回起動時に選択できます。一度設定したら変更できません。

### Q9. Excelファイルからもアプリを作成できますか？

**A.** はい、できます。

1. ExcelファイルまたはCSVファイルをアップロード
2. データを確認・設定
3. アプリを作成

Excelファイルの場合は、認証不要で使えます。

### Q10. サポートが必要な場合は？

**A.** 以下の方法でサポートを受けられます：

- GitHubのIssuesで質問・報告
- README.mdを確認
- サンプルファイルをダウンロードして形式を確認

---

## トラブルシューティング

### 問題が解決しない場合

1. ブラウザのコンソール（F12）でエラーメッセージを確認
2. エラーメッセージの内容をGitHubのIssuesで報告
3. 使用しているブラウザとバージョンを記載

### よくある問題

- **データが表示されない**
  - スプレッドシートの1行目に見出しがあるか確認
  - 2行目以降にデータがあるか確認

- **ボタンが反応しない**
  - ブラウザのキャッシュをクリア（Ctrl+Shift+R）
  - 最新版のGitHub Pagesで確認

- **エラーが多すぎる**
  - `file://`プロトコルで開いていないか確認
  - GitHub Pagesまたはローカルサーバーを使用

